Prompt_2 – Logikai Felépítés (Epubly.hu - Modular Refactor)

Az alkalmazás üzleti logikáját ES6 modulokra bontva, a `js/modules/` mappában kell megvalósítani. Az `app.js` feladata kizárólag a modulok importálása és a globális `Epubly` névtér összeállítása.

Modul Struktúra:
1. `state.js`: Központi állapot (zip, spine, metadata, currentBookId) exportálása `State` néven.
2. `storage.js`: IndexedDB (`getDb`, `saveBook`, `handleFileUpload`) és LocalStorage kezelés exportálása `Storage` néven.
3. `engine.js`: EPUB parse, PDF render, fejezetek DOM-ba illesztése. Export: `Engine`.
4. `ui.js`: DOM eseménykezelők, modális ablakok (Modal), oldalsávok (Sidebar) vezérlése. Export: `UI`.
5. `library.js`: Könyvtár nézet (Grid) és borító generálás (SVG). Export: `Library`.
6. `settings.js`: Beállítások (betűméret, téma, zoom) betöltése és mentése. Export: `Settings`.
7. `reader_settings.js`: A beállítások vizuális alkalmazása (`applySettings`) a DOM-ra. Export: `Reader`.
8. `navigation.js`: Lapozás (`turnPage`) és előzmények (`pushState`). Export: `Navigation`.
9. `search.js`: Keresési algoritmus. Export: `Search`.
10. `toc.js`: Tartalomjegyzék generálás. Export: `TOC`.
11. `utils.js`: Segédfüggvények (path resolve) és hibakezelés.

Működési elv:
- A modulok egymást a globális `window.Epubly` objektumon keresztül érik el futásidőben (pl. `Epubly.storage.saveBook`).
- Az `app.js` inicializálja (`init()`) a rendszert a DOMContentLoaded eseménykor.

Ez a második lépés. Kérlek, erősítsd meg, hogy érted a moduláris logikát, és várd a következő utasítást a dizájnról! Ne generálj még kódot.